# 開発ガイドライン (Development Guidelines)

<!--
  このテンプレートは docs/development-guidelines.md を生成するためのひな形です。
  実装規約 (implementation.md) と開発プロセス (process.md) の両方の内容を
  1つのドキュメントに統合して出力します。
  [プレースホルダ] は対象プロジェクトの言語・技術スタックに応じて置き換えてください。
-->

---

## コーディング規約

### 型定義・データ構造

<!-- 言語固有の型システム、構造体、クラス設計の方針を記述 -->

**原則**:
- [型/構造体/クラスの設計方針]
- [インターフェース/抽象型の設計方針]

**例**:
```[言語]
// ✅ 良い例
[具体的なコード例]

// ❌ 悪い例
[具体的なコード例]
```

### 命名規則

#### 変数・関数

**原則**:
- 変数: [命名スタイル]、名詞または名詞句
- 関数: [命名スタイル]、動詞で始める
- 定数: [命名スタイル]
- Boolean: [接頭辞ルール]

**例**:
```[言語]
// ✅ 良い例
[具体的なコード例]

// ❌ 悪い例
[具体的なコード例]
```

#### 型・クラス・インターフェース

**原則**:
- [型/クラスの命名スタイルと規則]
- [インターフェースの命名スタイルと規則]

**例**:
```[言語]
[具体的なコード例]
```

#### その他の命名規則

<!-- 言語固有の命名慣習があれば記述 (レシーバ名、頭字語、パッケージ名など) -->

| 対象 | 規則 | 例 |
|---|---|---|
| [対象1] | [規則] | [例] |
| [対象2] | [規則] | [例] |

### コードフォーマット

**インデント**: [スペース数/タブ]

**行の長さ**: 最大 [数値] 文字

**フォーマッター**: [ツール名]

### 関数設計

**原則**:
- 単一責務: 1つの関数は1つの責務
- 関数の長さ: [推奨行数] 行以内を目標
- パラメータ数: [上限数] 個を超える場合はオブジェクト/構造体でまとめる

**例**:
```[言語]
// ✅ 良い例: パラメータが多い場合
[オプション構造体/オブジェクトパターンの例]

// ❌ 悪い例: パラメータが多すぎる
[悪い例]
```

### エラーハンドリング

**原則**:
- 予期されるエラー: [処理方針]
- 予期しないエラー: [伝播方針]
- エラーを無視しない

**カスタムエラーの定義**:
```[言語]
[エラー型/クラスの定義例]
```

**エラーハンドリングパターン**:
```[言語]
// ✅ 良い例
[具体的なコード例]

// ❌ 悪い例
[具体的なコード例]
```

### コメント規約

**ドキュメントコメント**:
```[言語]
[ドキュメントコメントの書式例]
```

**インラインコメント**:
```
// ✅ 良い例: なぜそうするかを説明
// [理由を記述したコメント例]

// ❌ 悪い例: 何をしているか (コードを見れば分かる)
// [不要なコメント例]
```

### セキュリティ

**入力検証**: 境界 (ハンドラ/コントローラ) で検証する

**機密情報**: 環境変数から読み込み、ハードコードしない

**インジェクション対策**: プレースホルダ/パラメータバインドを使用する

### パフォーマンス

<!-- 言語固有のパフォーマンス注意点を記述 -->

- [データ構造の事前確保]
- [不要なアロケーション回避]
- [N+1 問題の回避]
- [その他言語固有の注意点]

---

## Git 運用ルール

### ブランチ戦略

**ブランチ種別**:
- `main`: 本番環境にデプロイ可能な状態
- `develop`: 開発の最新状態
- `feature/[機能名]`: 新機能開発
- `fix/[修正内容]`: バグ修正
- `refactor/[対象]`: リファクタリング

**フロー**:
```
main
  └─ develop
      ├─ feature/[機能名]
      ├─ fix/[修正内容]
      └─ release/[バージョン] (必要に応じて)
```

**マージ方針**:
- feature → develop: [squash merge / merge commit]
- develop → main: [merge commit / タグ付け方針]

### コミットメッセージ規約

**フォーマット** (Conventional Commits):
```
<type>(<scope>): <subject>

<body>

<footer>
```

**Type 一覧**:

| Type | 説明 |
|---|---|
| feat | 新機能 |
| fix | バグ修正 |
| docs | ドキュメント |
| style | フォーマット (動作に影響なし) |
| refactor | リファクタリング |
| perf | パフォーマンス改善 |
| test | テスト追加・修正 |
| build | ビルドシステム |
| ci | CI/CD 設定 |
| chore | その他 |

### プルリクエストプロセス

**作成前のチェック**:
- [ ] 全てのテストがパス
- [ ] Lint / 静的解析エラーがない
- [ ] 競合が解決されている

**PR テンプレート**:
```markdown
## 変更の種類
- [ ] 新機能 (feat)
- [ ] バグ修正 (fix)
- [ ] リファクタリング (refactor)
- [ ] ドキュメント (docs)
- [ ] その他 (chore)

## 変更内容
### 何を変更したか
[簡潔な説明]

### なぜ変更したか
[背景・理由]

### どのように変更したか
- [変更点1]
- [変更点2]

## テスト
- [ ] ユニットテスト追加
- [ ] 統合テスト追加
- [ ] 手動テスト実施

## 関連 Issue
Closes #[番号]
```

**レビュープロセス**:
1. セルフレビュー
2. 自動テスト実行
3. レビュアーアサイン
4. レビューフィードバック対応
5. 承認後マージ

---

## テスト戦略

### テストピラミッド

```
       /\
      /E2E\       少 (遅い、高コスト)
     /------\
    / 統合   \     中
   /----------\
  / ユニット   \   多 (速い、低コスト)
 /--------------\
```

**目標比率**:
- ユニットテスト: 70%
- 統合テスト: 20%
- E2E テスト: 10%

### テストの種類

#### ユニットテスト

**対象**: 個別の関数・クラス・メソッド

**カバレッジ目標**:

| 対象 | 目標 |
|---|---|
| 全体 | [数値]% 以上 |
| ビジネスロジック層 | [数値]% 以上 |

#### 統合テスト

**対象**: 複数コンポーネントの連携

#### E2E テスト

**対象**: ユーザーシナリオ全体

### テスト命名規則

**パターン**: `[対象]_[条件]_[期待結果]`

```
// ✅ 良い例
create_emptyTitle_returnsValidationError
findById_existingId_returnsEntity
delete_nonExistentId_returnsNotFoundError

// ❌ 悪い例
test1
works
shouldWorkCorrectly
```

### モック・スタブの使用

**原則**:
- 外部依存 (API、DB、ファイルシステム) はモック化
- ビジネスロジックは実際の実装を使用

---

## コードレビュー基準

### レビューポイント

**機能性**:
- [ ] 要件を満たしているか
- [ ] エッジケースが考慮されているか
- [ ] エラーハンドリングが適切か

**可読性**:
- [ ] 命名が明確か
- [ ] コメントが適切か
- [ ] 複雑なロジックが説明されているか

**保守性**:
- [ ] 重複コードがないか
- [ ] 責務が明確に分離されているか
- [ ] 変更の影響範囲が限定的か

**パフォーマンス**:
- [ ] N+1 問題がないか
- [ ] 不要な計算がないか
- [ ] メモリリークの可能性がないか

**セキュリティ**:
- [ ] 入力検証が適切か
- [ ] 機密情報がハードコードされていないか
- [ ] 権限チェックが実装されているか

### レビューコメントの優先度

- `[必須]`: 修正必須
- `[推奨]`: 修正推奨
- `[提案]`: 検討してほしい
- `[質問]`: 理解のための質問

---

## 品質自動化

### 自動化カテゴリ

| カテゴリ | ツール | 用途 |
|---|---|---|
| フォーマット | [ツール名] | コードスタイルの自動整形 |
| Lint | [ツール名] | コーディング規約の自動検出 |
| 静的解析 | [ツール名] | 型チェック・論理エラーの検出 |
| テスト | [ツール名] | ユニット・統合テストの実行 |
| ビルド | [ツール名] | コンパイル・ビルド確認 |

### CI/CD パイプライン

```yaml
# .github/workflows/ci.yml (例)
name: CI
on: [push, pull_request]
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - [言語セットアップ]
      - [依存関係インストール]
      - [Lint 実行]
      - [静的解析 実行]
      - [テスト実行]
      - [ビルド確認]
```

---

## 開発環境セットアップ

### 必要なツール

| ツール | バージョン | インストール方法 |
|---|---|---|
| [ツール1] | [バージョン] | [コマンド] |
| [ツール2] | [バージョン] | [コマンド] |

### セットアップ手順

```bash
# 1. リポジトリのクローン
git clone [URL]
cd [project-name]

# 2. 依存関係のインストール
[インストールコマンド]

# 3. 環境変数の設定
cp .env.example .env

# 4. 開発サーバーの起動
[起動コマンド]
```

---

## チェックリスト

### コーディング規約
- [ ] 命名規則に従っている
- [ ] 関数が単一の責務を持っている
- [ ] エラーハンドリングが実装されている
- [ ] マジックナンバーがない
- [ ] セキュリティ (入力検証、機密情報管理) が適切

### 開発プロセス
- [ ] ブランチ戦略が決まっている
- [ ] コミットメッセージ規約が明確である
- [ ] PR テンプレートが用意されている
- [ ] テストの種類とカバレッジ目標が設定されている
- [ ] コードレビュープロセスが定義されている
- [ ] CI/CD パイプラインが構築されている
